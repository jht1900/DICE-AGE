/* ldv1.c*/#include <Quickdraw.h>#include <stdio.h>#include "pioneer.h"typedef struct cmd	{	char	*name;	int		cmd;	int		nargs;	}	Cmd;	Cmd cmds[] = {	{ "setaudio", SetAudio, 1 },	{ "to", AutoStop, 1 },	{ "df", DisplayFrame, 1 },	{ "play", Play, 0 },	{ "go", Search, 1 },	{ "nretry", SearchRetry, 1 },	{ "slow", SlowSpeed, 1 },	{ "fast", FastSpeed, 1 },	{ "gof", SearchFwd, 1 },	{ "gor", SearchRev, 1 },	{ "stop", Stop, 0 },	{ "von", SetVideoOn, 0 },	{ "vof", SetVideoOff, 0 },	{ "1f", StepFwd, 0 },	{ "1r", StepRev, 0 },	{ "scanf", ScanFwd, 0 },	{ "scanr", ScanRev, 0 },	{ "binon", BinOutOn, 0 },	{ "binof", BinOutOff, 0 },	{ "getf", GimmeFrame, 0 },	{ 0, 0, 0 }	};	int vd;char qtrace = 1;main ()	{	Byte buf[128], str[128];	Byte *bp;	int	arg;		vd = VdOpen(0);		ooo();		for (;;)		{		gets(buf);		bp = buf;		GetTok(&bp, str);		GetNum(&bp, &arg);		Lookup(str, arg);		GetResponse();		}	}	Lookup(str, arg)	Byte	*str;	int		arg;	{	register Cmd *cm;			for (cm = &cmds[0]; cm->name; cm++)		{		if (strcmp(cm->name, str) == 0)			{			Vd(vd, cm->cmd, arg);			return;			}		}	if (str[0]) printf("Huh?\n");	else ListCmds();	}	ListCmds()	{	register Cmd *cm;		printf("\n");	for (cm = &cmds[0]; cm->name; cm++)		{		printf("%s %c\n", cm->name, cm->nargs? 'n': ' ');		}	printf("\n");	}	GetResponse()	{	long count;	Byte buf[32];	int	er, n;		SerGetBuf(vd + 1, &count);		if (count > 31) count = 31;		if (count > 0)		{		er = FSRead(vd + 1, &count, buf);		if (er) printf("FSRead er=%d on count=%d\n", er, count);		buf[count] = 0;		sscanf(buf, "%x", &n);		printf("LDV: %u\n", n);		}	}	#define WhiteSpace(x) ((x) == ' ' || (x) == '\t')GetTok(bp, str)	register Byte	**bp;	register Byte	*str;	{	while (**bp && WhiteSpace(**bp)) (*bp)++;		while (**bp && ! WhiteSpace(**bp)) 		{		*str++ = **bp;		(*bp)++;		}	*str = 0;	}	GetNum(bp, n)	Byte	**bp;	int		*n;	{	Byte	str[128];		GetTok(bp, str);		*n = atoi(str);	}	OhShit(a, b, c, d, e, f, g)	long a, b, c, d, e, f, g;	{	printf(a, b, c, d, e, f, g);	exit(0);	}	ooo()	{	FILE *of;	int	i;	char *type;		of = fopen("asciiTable.h", "w");	for (i = 0; i < 256; i++)		{		if (i > 126 || i <= 0x20) type = "qWHITE";		else if (i >= '0' && i <= '9') type = "qDIGIT";		else type = "qALPHA";				fprintf(of, "/* %#.02x %c */	%s,\n", i, 				(i>0x20 && i < 0x7f)? i: ' ', type);		}	fclose(of);	}	