/**/#include "cGlob.h"/* ---------------------------------------------------------------------- */extern cEnv			ce;/* ---------------------------------------------------------------------- */cShowWorld()	{	HashTab		*htab = ce.idTab;	short		hi;	cList		*cl;		for (hi = 0; hi < htab->tabSize; hi++)		{		if (Button()) { xprintf("...\n"); return; }		cl = htab->tab[hi];		for (; cl ; cl = cl->next)			{			cShowEnt(cl->ent);			}		}	}	/* -------------------------------------------------------------------------- */static int indent;#define tabWidth 4/* -------------------------------------------------------------------------- */cShowEnt(id)	Ent		*id;	{	Ent		*df;	if (Button()) { xprintf("...\n"); return; }	if (id->idEnt.et != IdEntType)		return;		indent = 0;	xprintf("\nId=%s\n", id->idEnt.name+1);	cShowThing(id->idEnt.def, 1);	}/* -------------------------------------------------------------------------- */static cShowThing(it, deep)	Ent		*it;	short	deep;	{	int		i;		if (! it)		return;		if (Button()) { xprintf("...\n"); return; }			indent += tabWidth;	cShowIndent();		switch (it->tabEnt.et)		{		case IdEntType:			xprintf("ID=%s\n", it->idEnt.name + 1);			break;				case EnumEntType:			break;					case ConstEntType:			switch (it->constEnt.size)				{				case 1:					xprintf("CONST=%d ", * (char *) it->constEnt.name);					break;				case 2:					xprintf("CONST=%d ", * (short *) it->constEnt.name);					break;				case 4:					xprintf("CONST=%ld ", * (long *) it->constEnt.name);					break;				default:					xprintf("CONST=0x%lx ", it->constEnt.name);					break;				}			cShowType(it->constEnt.type, deep);			break;		case FuncDefType:			break;					case VarDefType:			cShowType(it->varDef.type, deep);			indent -= tabWidth;			cShowThing(it->varDef.def, deep);			indent += tabWidth;			break;					case TypedefDefType:			break;								default:			xprintf("type=%d\n", it->tabEnt.et);			break;		}		indent -= tabWidth;	}	/* -------------------------------------------------------------------------- */static cShowIndent()	{	int		i;		for (i = 0; i < indent; i++) xprintf(" ");	}	/* -------------------------------------------------------------------------- */static char	*typeTab[] = { "void", "int", "float" };/* -------------------------------------------------------------------------- */static cShowType(ty, deep)	TypeEnt		*ty;	short		deep;	{	AggreMember	*me;		if (Button()) { xprintf("...\n"); return; }		for (; ty; ty = ty->derefType.to)		{		switch (ty->tabEnt.et)			{			case SimpleTypeType:				xprintf("%s size=%d %s\n", 							typeTab[ty->simpleType.type],							ty->simpleType.size,							ty->simpleType.unsign? "unsigned": "");				return;				break;						case StructEntType:			case UnionEntType:				xprintf("Aggre=%s size=%ld\n",							ty->aggreType.name? ty->aggreType.name->tabEnt.name + 1									: "-",							ty->aggreType.size);				if (! deep) return;				indent += tabWidth;				for (me = ty->aggreType.memList; me; me = me->next)					{					cShowIndent();					xprintf("mem=%s o=%ld fz=%d bo=%d ",							me->nameId->tabEnt.name + 1, me->offset,							me->fieldWidth, me->bitOffset);					cShowType(me->type, 0);					}				indent -= tabWidth;				return;				break;						case FuncTypeType:				xprintf("Func ");				break;							case ArrayTypeType:				xprintf("[%ld] ", ty->arrayType.dim);				break;							case PtrTypeType:				xprintf("Ptr ");				break;			}		}	xprintf("\n");	}	/* -------------------------------------------------------------------------- */