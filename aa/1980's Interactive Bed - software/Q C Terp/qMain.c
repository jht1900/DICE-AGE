/*Small Lisp interpreter. Qlisp.11/11/87 Phase two. Event and message based.It's not black, It's not whiteit's nothing that you can see*/#include <Quickdraw.h>#include <ResourceMgr.h>#include <EventMgr.h>#include <stdio.h>#include "qDef.h"#include "Obj.h"/* ---------------------------------------------------------------------- */char 			qtrace = 0;#define TRACE(a,b) if (qtrace>=a) printf bEnv				*ev;Object			me;Object			listenerWindow;Object			consoleWindow;qItem			windowList;#include <setjmp.h>jmp_buf			topleveljb;int				fdload;/* -------------- main ------------------------------------------------ */static Rect	txtRect = { 40, 2, 170, 470 };main ()	{	MacInits();	qLispInits();		windowList = NIL;	TxtNew(&txtRect, "\pConsole");	consoleWindow = me;		OffsetRect(&txtRect, 0, 160);	TxtNew(&txtRect, "\pListener");	listenerWindow = me;		for (;;)		{		if (setjmp(topleveljb) == 0)			AcceptEvent();		else if (fdload >= 0)			ReloadEnv();		}	}	/* --------------------- qLispInits ----------------------------------- */static qLispInits()	{					/* tabSize, symsUnit, strsUnit, consUnit */	ev = NewEnv(1009, 256, 1024, 1024);	InitSyms();		InitFuncs();	InitConsole();	printf("Yooh!\n");	}	/* --------------------- ReloadEnv ------------------------------------- */static ReloadEnv()	{	FreeEnv();	LoadEnv( fdload);	InitSyms();	InitFuncs();	InitConsole();	}	/* ----------------- InitFuncs ----------------------------------------- */static InitFuncs()	{	extern qIfunc	qPrimIfunc;	extern qIfunc	qPrimMacIfunc;	InternIfuncs( &qPrimIfunc);	InternIfuncs( &qPrimMacIfunc);		}	/* --------------------- OhShit --------------------------------------- */OhShit(ex, a, b, c, d, e, f, g)	int ex;	long a, b, c, d, e, f, g;	{	printf(a, b, c, d, e, f, g);	if (ex) exit(0);	}	/* ------------------------ MacInits ---------------------------------- */static MacInits()	{	InitGraf(&thePort);	InitFonts();	FlushEvents(everyEvent, 0);	InitWindows();	InitMenus();	TEInit();	InitDialogs(0L);	MaxApplZone();#if 0	SetupGrowZone();#endif	SetupCursors();	SetupMenus();	Stdio_MacInit(TRUE);		Click_On(0);	/* Don't ask us to confirm on exit */			}	/* -------------------------------------------------------------------- */