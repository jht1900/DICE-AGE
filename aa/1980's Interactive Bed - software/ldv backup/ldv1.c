/* ldv1.cIt's not black, It's not whiteit's nothing that you can see*/#include "qDef.h"#include "vdisc.h"char 			qtrace = 0;#define TRACE(a,b) if (qtrace>=a) printf bEnv				*ev;#include <setjmp.h>jmp_buf			topleveljb;int				fdload;main ()	{	Click_On(0);					/* tabSize, symsUnit, strsUnit, consUnit */	ev = NewEnv(1009, 256, 1024, 1024);	InitSyms(ev);		InitFuncs(ev);	InitConsole(ev);	printf("Yeah. Live clear\nHeart Mind Purpose\n\n");		SetupCursors();	OpenMacEnhancer();		InitPorts();	MagPortB();	MagInit();	#if 0	ReadFile(ev, "\ppioneer-ops");	ReadFile(ev, "\ppp");#endif	fdload = -1;	for (;;)		{		if (setjmp(topleveljb) == 0)			{			ReadEval(ev);			}		else if (fdload == -1)			{			InitConsole(ev);			}		else if (fdload > -1) {			FreeEnv(ev);			LoadEnv(ev, fdload);			InitSyms(ev);			InitFuncs(ev);			InitConsole(ev);			}		}	}	InitFuncs(ev)	Env				*ev;	{	extern qIfunc	qPrimIfunc;	extern qIfunc	qPrimMacIfunc;	extern qIfunc	ldvFuncs[];	extern qIfunc	movieFuncs[];	InternIfuncs(ev, &qPrimIfunc);	InternIfuncs(ev, &qPrimMacIfunc);		InternIfuncs(ev, &ldvFuncs);	InternIfuncs(ev, &movieFuncs);	}	ReadEval(ev)	Env				*ev;	{	register qItem	q, fp;	int				n;	qList			*lp;		q = ReadConsole(ev, "> ");	if (Symbolp(q))		{		fp = ((qSymbol *)q)->func;		n = Nargs(fp);		if (n >= 0)			{			for (lp = (qList *)NIL; n > 0; n--)				{				lp = Cons(ev, ReadConsole(ev, "Arg> "), lp);				}			lp = Nreverse(lp);			lp = Cons(ev, q, lp);			q = Eval(ev, lp);			}		else {			q = ((qSymbol *)q)->val;			}		}	else {		q = Eval(ev, q);		}			PrintConsole(ev, q);	}	OhShit(str)	Byte	*str;	{	DebugStr(str);	}	/* ---------------------------- SelPort -------------------------------- */extern Object	ldvfourObj;extern Object	ldvsixObj;int				vidport;Object			obj;InitPorts()	{	obj = ldvfourObj;	SelPort(AUD);	z(VIDEO,1);	z(AUDIO,3);	z(STOP,0);	SelPort(VID);	z(FRAME,0);	z(CLEARTEXT,0);	z(STOP,0);	z(CHARGEN,1);	z(VIDEO,0);	z(AUDIO,0);	z(AUDIOSQ,0);	}	SelPort(n)	{	vidport = n;#if 0	if (n == VID)		{		obj = ldvsixObj;		macen(0x83);		}	else		{		obj = ldvfourObj;		eport(n);		}#else	eport(n);#endif	z(INIT,0);	}	/* ------------------------- ThrowToTop -------------------------------- */ThrowToTop()	{	fdload = -1;	longjmp(topleveljb, 1);	}	/* ------------------------- doalert ----------------------------------- */#define AlertId	31868doalert(p0, p1, p2, p3)	Byte	*p0, *p1, *p2, *p3;	{	ParamText(p0, p1, p2, p3);	StopAlert(AlertId, 0L);	}	/* -------------------------------------------------------------------- */