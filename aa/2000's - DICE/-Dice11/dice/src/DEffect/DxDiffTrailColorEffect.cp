// --------------------------------------------------------------------------------//// DiffTrailColorEffect -- colorize the changes.//// 2005.02.27 	jht		Created.//// Copyright (c) 2005 John Henry Thompson. All rights reserved.// --------------------------------------------------------------------------------#include "DxDiffTrailColorEffect.h"#include "DxImage_js.h"#include "DxImage.h"#include "dicejs.h"// --------------------------------------------------------------------------------DxDiffTrailColorEffect::DxDiffTrailColorEffect(void *wrapperObj )	: DxDiffEffect(wrapperObj ){	this->diffTolerance = 40;}#if 0// --------------------------------------------------------------------------------DxDiffTrailColorEffect::~DxDiffTrailColorEffect(){}#endif// ---------------------------------------------------------------------------------void	DxDiffTrailColorEffect::ComputeImage(){	int		capPix;	int 	diffwPix;	int		diffTolerance_x3;	int		color_int[3];		diffTolerance_x3 = this->diffTolerance * 3;	if (this->color)	{		color_int[0] = this->color->red;		color_int[1] = this->color->green;		color_int[2] = this->color->blue;	}	else	{		color_int[0] = 255;		color_int[1] = 255;		color_int[2] = 255;	}	#define CODE_INNER_LOOP \	/* leave image as random color trail */ \	capPix = sourceLinePtr[0] + sourceLinePtr[1] + sourceLinePtr[2];   \	diffwPix = (previousLinePtr[0] + previousLinePtr[1] + previousLinePtr[2]) - capPix;  \	if (diffwPix < -diffTolerance_x3 || diffwPix > diffTolerance_x3) \	{ \		/* There is  difference, some gray */ \		outputLinePtr[0] = color_int[0]; \		outputLinePtr[1] = color_int[1]; \		outputLinePtr[2] = color_int[2]; \	} \#include "DiffEffectLoop.inc"}// --------------------------------------------------------------------------------// --------------------------------------------------------------------------------